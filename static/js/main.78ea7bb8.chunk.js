(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{309:function(t,e,n){},310:function(t,e,n){},316:function(t,e){},317:function(t,e){},325:function(t,e){},328:function(t,e){},329:function(t,e){},358:function(t,e,n){"use strict";n.r(e);var a=n(43),i=n(53),s=n.n(i),o=n(259),r=n.n(o),c=(n(309),n(310),n(144)),l=n(6),u={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pauseBreak:19,capsLock:20,escape:27,pageUp:33,Space:32,pageDown:34,end:35,home:36,arrowLeft:37,arrowUp:38,arrowRight:39,arrowDown:40,printScreen:44,insert:45,delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindowKey:91,rightWindowKey:92,selectKey:93,numpad0:96,numpad1:97,numpad2:98,numpad3:99,numpad4:100,numpad5:101,numpad6:102,numpad7:103,numpad8:104,numpad9:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numLock:144,scrollLock:145,MyComputer:182,MyCalculator:183,semiColon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,openBracket:219,backSlash:220,closeBraket:221,singleQuote:222},p=n(18),f=n(5),d=n(10),h=250,y=250,g=10,m="LEFT",b="RIGHT",v="UP",j="DOWN",x="PLAY",w="PAUSE",O="STOP",k=n(281),S=function(){function t(e){var n=this;Object(f.a)(this,t),this.players=["player","player2"],this.initialState={gameStatus:w,winner:"none",player:{currentPoints:0,color:"#2196f3",direction:b,speed:10,positions:[{x:0,y:0}]},player2:{currentPoints:0,color:"#00b248",direction:m,speed:10,positions:[{x:240,y:240}]},food:{x:0,y:0}},this.state=JSON.parse(JSON.stringify(this.initialState)),this.initialized=!1,this.getStateTensor=function(){var t=Array(25).fill().map((function(){return Array(25).fill(0)}));return n.state.player.positions.forEach((function(e){t[e.x/10][e.y/10]=1})),t=t.flat(),k.a([].concat(Object(p.a)(t),[(n.state.food.x/10-0)/25,(n.state.food.y/10-0)/25]),[1,t.length+2])},this.isInverseDirection=function(t,e){switch(e){case b:if(n.state[t].direction===m)return!0;break;case m:if(n.state[t].direction===b)return!0;break;case v:if(n.state[t].direction===j)return!0;break;case j:if(n.state[t].direction===v)return!0;break;default:return!1}return!1},this.initialize=function(t){n.ctx=t,n.generateFoodPosition(),n.initialized=!0},this.distanceBetweenHeads=function(){var t=n.state.player.positions[0].x-n.state.player2.positions[0].x,e=n.state.player.positions[0].y-n.state.player2.positions[0].y;return Math.sqrt(Math.pow(t,2)+Math.pow(e,2))},this.headCollision=function(){return!!(n.state.player.positions[0].x===n.state.player2.positions[0].x&&n.state.player.positions[0].y===n.state.player2.positions[0].y||n.isInverseDirection("player",n.state.player2.direction)&&n.distanceBetweenHeads()===g)&&(console.log("draw"),!0)},this.getOtherPlayer=function(t){return"player"===t?"player2":"player"},this.hasCollisions=function(){if(n.headCollision())return n.getCurrentLooser();for(var t=0;t<n.players.length;t++)for(var e=n.players[t],a=n.getOtherPlayer(e),i=1;i<n.state[e].positions.length;i++){if(n.state[e].positions[i].x===n.state[e].positions[0].x&&n.state[e].positions[i].y===n.state[e].positions[0].y)return e;if(n.state[a].positions[0].x===n.state[e].positions[i].x&&n.state[a].positions[0].y===n.state[e].positions[i].y)return a}return"none"},this.updateTail=function(t){n.state[t].positions=n.state[t].positions.map((function(e,a){return 0===a?e:Object(c.a)({},n.state[t].positions[a-1])}))},this.moveUp=function(t){n.updateTail(t),n.state[t].positions[0].y-n.state[t].speed>=0?n.state[t].positions[0].y-=n.state[t].speed:n.state[t].positions[0].y=240},this.moveDown=function(t){n.updateTail(t),n.state[t].positions[0].y+n.state[t].speed<=y-n.state[t].speed?n.state[t].positions[0].y+=n.state[t].speed:n.state[t].positions[0].y=0},this.moveLeft=function(t){n.updateTail(t),n.state[t].positions[0].x-n.state[t].speed>=0?n.state[t].positions[0].x-=n.state[t].speed:n.state[t].positions[0].x=240},this.moveRight=function(t){n.updateTail(t),n.state[t].positions[0].x+n.state[t].speed<=h-n.state[t].speed?n.state[t].positions[0].x+=n.state[t].speed:n.state[t].positions[0].x=0},this.autoMove=function(){n.players.forEach((function(t){switch(n.state[t].direction){case b:n.moveRight(t);break;case m:n.moveLeft(t);break;case v:n.moveUp(t);break;case j:n.moveDown(t)}}))},this.pauseGame=function(){clearInterval(n.gameTimer),n.state.gameStatus=w},this.startGame=function(){n.state.gameStatus=x,clearInterval(n.gameTimer),n.gameTimer=setInterval(n.update,200)},this.getCurrentLooser=function(){return n.state.player.positions.length>n.state.player2.positions.length?"player2":n.state.player.positions.length<n.state.player2.positions.length?"player":"draw"},this.stopGame=function(){n.state.gameStatus=O,clearInterval(n.gameTimer);var t=n.getCurrentLooser();n.state.winner="draw"===t?t:n.getOtherPlayer(t)},this.getPlayersLength=function(){return{p1:n.state.player.positions.length-1,p2:n.state.player2.positions.length-1}},this.restartGame=function(){n.ctx.clearRect(0,0,n.ctx.canvas.width,n.ctx.canvas.height),clearInterval(n.gameTimer),n.state=Object(c.a)({},JSON.parse(JSON.stringify(n.initialState))),n.generateFoodPosition()},this.update=function(){if(n.state.gameStatus===x){var t=n.hasCollisions();"none"!==t&&(n.state.gameStatus=O,n.state.winner="draw"===t?"draw":n.getOtherPlayer(t)),n.autoMove(),n.draw()}},this.getStatus=function(){return n.state.gameStatus},this.getPoints=function(){return n.state.currentPoints},this.eatFood=function(){n.players.forEach((function(t){n.state[t].positions[0].x===n.state.food.x-5&&n.state[t].positions[0].y===n.state.food.y-5&&(n.generateFoodPosition(),n.state[t].positions=[].concat(Object(p.a)(n.state[t].positions),[{x:h,y:y}]),n.state.currentPoints++)}))},this.foodInSnake=function(){for(var t=0;t<n.players.length;t++)for(var e=n.players[t],a=0;a<n.state[e].positions.length;a++)if(n.state[e].positions[a].x===n.state.food.x&&n.state[e].positions[a].y===n.state.food.y)return!0;return!1},this.getWinner=function(){return n.state.winner},this.generateFoodPosition=function(){do{n.state.food.x=n.getRandomCirclePosition(h),n.state.food.y=n.getRandomCirclePosition(y)}while(n.foodInSnake())},this.drawFood=function(){var t=new Path2D;t.arc(n.state.food.x,n.state.food.y,5,0,360),n.ctx.fillStyle="red",n.ctx.fill(t)},this.drawPlayer=function(){n.players.forEach((function(t){var e=new Path2D;n.state[t].positions.forEach((function(a){n.ctx.fillStyle=n.state[t].color,e.rect(a.x,a.y,g,g),n.ctx.fill(e)}))}))},this.draw=function(){n.ctx.clearRect(0,0,n.ctx.canvas.width,n.ctx.canvas.height),n.drawPlayer(),n.eatFood(),n.drawFood()},this.changeDirection=function(t,e){switch(e){case v:n.state[t].direction!==j&&(n.state[t].direction=e);break;case j:n.state[t].direction!==v&&(n.state[t].direction=e);break;case m:n.state[t].direction!==b&&(n.state[t].direction=e);break;case b:n.state[t].direction!==m&&(n.state[t].direction=e);break;default:n.state[t].direction=e}},e&&this.initialize(e)}return Object(d.a)(t,[{key:"getRandomCirclePosition",value:function(t){var e=0;do{e=Math.floor(Math.floor(Math.random()*Math.floor(t)))}while(e%10!==5);return e}}]),t}(),P=n(279),C=n.n(P),L=n(280),T=n.n(L)()("https://95f18594e8f8.ngrok.io"),I=new S,E=function(t){var e=Object(i.useState)("player"),n=Object(l.a)(e,2),s=n[0],o=n[1],r=Object(i.useState)(I.getWinner()),p=Object(l.a)(r,2),f=p[0],d=p[1],h=Object(i.useState)(60),y=Object(l.a)(h,2),g=y[0],x=y[1],w=Object(i.useState)(!1),O=Object(l.a)(w,2),k=O[0],S=O[1],P=Object(i.useState)(I.getPlayersLength()),L=Object(l.a)(P,2),E=L[0],F=L[1],D=Object(i.useRef)(null);Object(i.useEffect)((function(){return T.on("action",(function(t){var e=t.player,n=t.direction;I.changeDirection(e,n)})),T.on("start",(function(t){console.log(t),S(!0),I.startGame()})),T.on("pause",(function(t){console.log(t),S(!1),I.pauseGame()})),T.on("retart",(function(t){console.log(t),x(60),S(!1),I.restartGame()})),function(){T.removeListener("action"),T.removeListener("start"),T.removeListener("pause"),T.removeListener("restart")}}),[]),Object(i.useEffect)((function(){"none"!==f&&S(!1)}),[f]);Object(i.useEffect)((function(){var t=setInterval((function(){k&&g>0&&x(g-1),0===g&&(I.stopGame(),S(!1))}),1e3);return function(){clearInterval(t)}}),[k,g]),Object(i.useEffect)((function(){var t=setInterval((function(){d(I.getWinner()),F(I.getPlayersLength())}),200);return function(){clearInterval(t)}}),[]);Object(i.useEffect)((function(){var t=D.current.getContext("2d");I.initialize(t)}),[]);return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(C.a,{handleKeys:["w","a","s","d"],onKeyEvent:function(t,e){switch(e.keyCode){case u.w:case u.arrowUp:T.emit("action",{player:s,direction:v});break;case u.a:case u.arrowLeft:T.emit("action",{player:s,direction:m});break;case u.d:case u.arrowRight:T.emit("action",{player:s,direction:b});break;case u.s:case u.arrowDown:T.emit("action",{player:s,direction:j})}},handleEventType:"keydown"}),Object(a.jsxs)("div",{className:"game-container",children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("p",{children:E?"".concat(E.p1," ").concat(s," ").concat(E.p2):s}),Object(a.jsxs)("p",{children:["Winner: ","none"!==f?f:""]}),Object(a.jsx)("p",{children:g}),Object(a.jsx)("button",{onClick:function(){T.emit("start","".concat(s," started"))},children:"Start"}),Object(a.jsx)("button",{onClick:function(){T.emit("pause","".concat(s," paused"))},children:"Pause"}),Object(a.jsx)("button",{onClick:function(){T.emit("restart","".concat(s," restarted"))},children:"Restart"}),Object(a.jsx)("button",{onClick:function(t){o("player"===s?"player2":"player")},children:"changePlayer"})]}),Object(a.jsx)("div",{children:Object(a.jsx)("canvas",Object(c.a)(Object(c.a)({ref:D},t),{},{id:"canvas"}))})]})]})};var F=function(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(E,{width:"250",height:"250"})})},D=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,359)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,s=e.getLCP,o=e.getTTFB;n(t),a(t),i(t),s(t),o(t)}))};r.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(F,{})}),document.getElementById("root")),D()}},[[358,1,2]]]);
//# sourceMappingURL=main.78ea7bb8.chunk.js.map